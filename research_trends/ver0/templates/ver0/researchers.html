{% extends "ver0/layout.html" %}

{% block display_chart %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // todo: build a pie char?
        const pie_data = JSON.parse(document.getElementById('pie_data').textContent);
        if (pie_data["labels"].length == 0) {
            alert("Sorry, the author [" + pie_data['author'] + "] is not in our database.")
        } else {
            let ctx = document.getElementById("chart").getContext("2d");
            let chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: pie_data["labels"],
                    datasets: [
                        pie_data["datasets"]
                    ]
                },
                options: {
                    responsive: false,

                    title: {
                        display: true,
                        text: 'The research interest distribution of ' + pie_data['author']
                    },
                    legend: {
                        position: 'left'
                    }
                }
            });
        }

    })
</script>
{% endblock %}

{% block searchbox %}
<form action="{% url 'ver0:researchers' %}" method="post">
    {% csrf_token %} 
    {{form}}
    <input type="submit">
</form>

{{ pie_data|json_script:"pie_data"}}
<canvas id="chart" width="600" , height="600"></canvas>
{% endblock %}